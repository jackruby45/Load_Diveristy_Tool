<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Residential Load Diversity Calculator</title>
    <link rel="stylesheet" href="index.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ”¥</text></svg>">
    <script type="importmap">
        {
          "imports": {
            "jspdf": "https://esm.sh/jspdf@2.5.1",
            "jspdf-autotable": "https://esm.sh/jspdf-autotable@3.8.2"
          }
        }
    </script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <header>
        <h1>Residential Load Diversity Calculator</h1>
        <p>For Single-Family Residences in Maine & New England</p>
        <p class="attribution">By: Tim Bickford Rev 1.1 (08/21/2025)</p>
    </header>

    <main>
        <form id="calculator-form" onsubmit="return false;">
            <section id="project-info" aria-labelledby="project-info-heading">
                <h2 id="project-info-heading">Project Information</h2>
                <div class="grid-container">
                    <div class="form-group">
                        <label for="project-name">Project Name</label>
                        <input type="text" id="project-name" name="projectName" required>
                    </div>
                    <div class="form-group">
                        <label for="doc">DOC (Distribution Operating Company)</label>
                        <select id="doc" name="doc" required>
                            <option value="Unitil (NU-NH)">Unitil (NU-NH)</option>
                            <option value="Unitil (NU-ME)">Unitil (NU-ME)</option>
                            <option value="F.W. Webb (FG&E)">F.W. Webb (FG&E)</option>
                            <option value="Bangor Natural Gas (BNG)">Bangor Natural Gas (BNG)</option>
                            <option value="Maine Natural Gas (MNG)">Maine Natural Gas (MNG)</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="street-address">Street Number & Name</label>
                        <input type="text" id="street-address" name="streetAddress" required>
                    </div>
                    <div class="form-group">
                        <label for="town">Town</label>
                        <input type="text" id="town" name="town" required>
                    </div>
                    <div class="form-group">
                        <label for="state">State</label>
                        <select id="state" name="state" required>
                            <option value="ME">ME</option>
                            <option value="NH">NH</option>
                            <option value="MA">MA</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="g-intake">G-Intake Number</label>
                        <input type="text" id="g-intake" name="gIntake">
                    </div>
                    <div class="form-group">
                        <label for="assessed-by">Assessed by</label>
                        <input type="text" id="assessed-by" name="assessedBy" required>
                    </div>
                    <div class="form-group">
                        <label for="assessment-date">Assessment Date</label>
                        <input type="date" id="assessment-date" name="assessmentDate" required>
                    </div>
                    <div class="form-group">
                        <label for="revision-number">Revision Number</label>
                        <input type="number" id="revision-number" name="revisionNumber" value="0" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="revision-date">Revision Date</label>
                        <input type="date" id="revision-date" name="revisionDate" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="project-description">Project Description</label>
                        <textarea id="project-description" name="projectDescription" rows="4"></textarea>
                    </div>
                </div>
            </section>

            <section id="appliance-section" aria-labelledby="appliance-section-heading">
                <h2 id="appliance-section-heading">Appliance Input</h2>
                <div class="appliance-controls">
                    <div class="form-group">
                        <label for="gas-energy-content">Gas Energy Content (BTU/SCF)</label>
                        <input type="number" id="gas-energy-content" value="1000" min="1">
                    </div>
                    <button type="button" id="add-appliance-btn" class="button-primary">Add Appliance</button>
                </div>
                <div class="appliance-table-container">
                    <div id="appliance-list-header" class="appliance-row header">
                        <div>Category</div>
                        <div>Equipment Type</div>
                        <div>Max Input Rating</div>
                        <div>Units</div>
                        <div>Diversity Factor (%)</div>
                        <div>Action</div>
                    </div>
                    <div id="appliance-list">
                        <!-- Appliance rows will be dynamically inserted here -->
                    </div>
                </div>
            </section>

            <section id="calculation-section" aria-labelledby="calculation-section-heading">
                 <h2 id="calculation-section-heading">Calculate & Display Results</h2>
                <div class="results-controls">
                    <button type="button" id="calculate-btn" class="button-primary">Calculate</button>
                    <div class="form-group">
                        <label for="results-units">Display Units</label>
                        <select id="results-units">
                            <option value="BTU/hr">BTU/hr</option>
                            <option value="MMBTU/hr">MMBTU/hr</option>
                            <option value="CFH">CFH</option>
                        </select>
                    </div>
                </div>
                <div id="results-display" class="results-container">
                    <div class="result-item">
                        <span class="result-label">Total Connected Load:</span>
                        <span id="total-connected-load" class="result-value">0</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Diversified Load:</span>
                        <span id="total-diversified-load" class="result-value">0</span>
                    </div>
                </div>
            </section>

            <section id="file-ops-section" aria-labelledby="file-ops-heading">
                <h2 id="file-ops-heading">File Operations</h2>
                <div class="file-buttons">
                    <button type="button" id="save-btn" class="button-secondary">Save</button>
                    <button type="button" id="load-btn" class="button-secondary">Load</button>
                    <input type="file" id="load-input" accept=".json" style="display: none;">
                    <button type="button" id="export-pdf-btn" class="button-primary">Export to PDF</button>
                </div>
            </section>
        </form>
    </main>

    <footer>
        <p>Built by a world-class senior frontend engineer.</p>
    </footer>

    <script type="module" src="index.tsx"></script>
<script type="module" src="/index.tsx"></script>
</body>
</html>